{"version":3,"sources":["assets\\FSDK_ASS\\FSript\\FView\\FInvityPage.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { FGlobal } from \"../FModel/FGlobal\";\r\nimport { FInvityTaskItem } from \"./FInvityTaskItem\";\r\nimport { FSocketSend } from \"../FNetWork/FSocketSend\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class FInvityPage extends cc.Component {\r\n    @property(cc.Label)\r\n    mInviteCnt: cc.Label = null;\r\n    @property(cc.Label)\r\n    mInviteCode: cc.Label = null;\r\n    @property(cc.Label)\r\n    mInviteLink: cc.Label = null;\r\n    @property(cc.ScrollView)\r\n    mScroll: cc.ScrollView = null;\r\n    @property(cc.Node)\r\n    mInvityItem: cc.Node = null;\r\n    @property(cc.EditBox)\r\n    mInvityEdit: cc.EditBox = null;\r\n    @property(cc.Node)\r\n    mRewardNode: cc.Node = null;\r\n    @property(cc.Node)\r\n    mInviteNode: cc.Node = null;\r\n    @property(cc.Node)\r\n    mMsg1: cc.Node = null;\r\n    @property(cc.Node)\r\n    mMsg2: cc.Node = null;\r\n    onLoad() {\r\n        this.node.setContentSize(cc.winSize);\r\n        this.node.getChildByName(\"Top\").height = 85 + FGlobal.getScale();\r\n        this.mRewardNode.getComponent(cc.Widget).top = 700 + FGlobal.getScale();\r\n    }\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    closePage() {\r\n        this.node.parent = null;\r\n    }\r\n\r\n    onEnable() {\r\n        this.mScroll.stopAutoScroll();\r\n        this.mScroll.scrollToTop(0);\r\n        this.initData();\r\n        FSocketSend.C2S_trans_history('invite');\r\n        FSDK.addUserInfoListen(this.userInfoListen, this);\r\n        cc.director.on(FEventID.S2C_trans_history, this.S2C_trans, this);\r\n        FSDK.closeBanner();\r\n    }\r\n\r\n    onDisable() {\r\n        cc.director.off(FEventID.S2C_trans_history, this.S2C_trans, this);\r\n        FSDK.openBanner();\r\n    }\r\n\r\n    S2C_trans() {\r\n        let inviteTask = FGlobal.invite_task;\r\n        let inviteTaskConf = FConfig.conf.invite_task;\r\n        let num = 0;\r\n        let jj = 0;\r\n        for (let j = 0; j < inviteTaskConf.length; j++) {\r\n            if (FGlobal.USER_INFO.invite_count < inviteTaskConf[j].count && !num) {\r\n                jj = j;\r\n                num = inviteTaskConf[j].count;\r\n                this.mMsg1.getComponent(cc.Label).string = `Invite ${num - FGlobal.USER_INFO.invite_count} more friends can get rewards`;\r\n            }\r\n        }\r\n\r\n        if (inviteTask.length != jj) {\r\n            this.mMsg1.getComponent(cc.Label).string = `Your rewards haven't been cliamed`;\r\n        }\r\n    }\r\n\r\n    //userinfo监听\r\n    userInfoListen(data) {\r\n        this.initData();\r\n        FLog.normal(\"回调信息  \", data);\r\n    }\r\n\r\n    //初始化数据\r\n    initData() {\r\n        this.mRewardNode.active = FGlobal.USER_INFO.isFlag;\r\n        this.mInviteNode.active = !FGlobal.USER_INFO.isFlag && !FGlobal.USER_INFO.be_invite;\r\n        this.mInviteCnt.string = `Invite ${FGlobal.USER_INFO.invite_count} Friends`;\r\n        this.mInviteCode.string = FGlobal.USER_INFO.invite_code + '';\r\n        this.mInviteLink.string = FConfig.FSDK_CONF.link + '';\r\n        this.mMsg1.active = this.mMsg2.active = FGlobal.USER_INFO.isFlag;\r\n        this.initTask();\r\n    }\r\n\r\n    //复制按钮\r\n    copy(target, type) {\r\n        switch (type) {\r\n            case \"code\":\r\n                FSDK.copy(this.mInviteCode.string);\r\n                break;\r\n            case \"url\":\r\n                FSDK.copy(this.mInviteLink.string);\r\n                break;\r\n        }\r\n    }\r\n\r\n    //邀请按钮\r\n    clickInvite() {\r\n        FSDK.share(`${FConfig.GAME_NAME} have fun. What are you waiting for? Download it, input the refer code ${this.mInviteCode.string} to get reward. ${this.mInviteLink.string}`);\r\n    }\r\n\r\n    //初始化任务\r\n    initTask() {\r\n        FLog.normal(\"是不是conf \", FConfig.conf);\r\n        let inviteTask = FConfig.conf.invite_task;\r\n        let num = 0;\r\n        for (let j = 0; j < inviteTask.length; j++) {\r\n            if (FGlobal.USER_INFO.invite_count < inviteTask[j].count && !num) {\r\n                num = inviteTask[j].count;\r\n                this.mMsg1.getComponent(cc.Label).string = `Invite ${num - FGlobal.USER_INFO.invite_count} more friends can get rewards`;\r\n            }\r\n        }\r\n        for (let i = 0; i < inviteTask.length; i++) {\r\n            let item: cc.Node = null;\r\n            if (this.mScroll.content.childrenCount == inviteTask.length) {\r\n                item = this.mScroll.content.children[i];\r\n            }\r\n            else {\r\n                item = cc.instantiate(this.mInvityItem);\r\n                item.parent = this.mScroll.content;\r\n            }\r\n            item.getComponent(FInvityTaskItem).setData(i, inviteTask[i], this.node);\r\n        }\r\n    }\r\n\r\n    //填入邀请码\r\n    getCode() {\r\n        if (this.mInvityEdit.string.length > 0) {\r\n            FSocketSend.C2S_invited(this.mInvityEdit.string);\r\n        }\r\n        else {\r\n            FSDK.showToast('Sorry, the invitation code cannot be empty');\r\n        }\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}