{"version":3,"sources":["assets\\script\\game\\FCionEvent.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { user } from \"../common/User\";\r\nimport { events } from \"../common/Events\";\r\nimport { GameEvents, GameConstant } from \"../common/EventConstants\";\r\nimport { actions } from \"../common/Actions\";\r\nimport { PopUpName } from \"../common/PopupConstants\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class FCionEvent extends cc.Component {\r\n    @property(cc.Node)\r\n    tipsLable: cc.Node[] = [];\r\n\r\n    onLoad() {\r\n        this.initEvents();\r\n    }\r\n\r\n    initEvents() {\r\n        FSDK.addCreditListen(this.severCb, this);\r\n        events.on(this.name, this.uuid, GameEvents.OPENVDIEO, this.openVidoe, this)\r\n    }\r\n\r\n    onDestroy() {\r\n        events.removeListener(this.name, GameEvents.OPENVDIEO);\r\n    }\r\n\r\n    /**\r\n    * 服务器回调\r\n    * @param data \r\n    */\r\n    severCb(data) {\r\n        this.scheduleOnce(() => {\r\n            switch (data.type) {\r\n                case 'gp':\r\n                    this.tipsAnim(0, data.num - user.firstGold);\r\n                    user.firstGold = data.num;\r\n                    break;\r\n                case 'pp':\r\n                    this.tipsAnim(1, data.num - user.secondGold);\r\n                    user.secondGold = data.num;\r\n                    break;\r\n                case 'credit':\r\n                    this.tipsAnim(2, data.num - user.credit);\r\n                    user.credit = data.num;\r\n                    break;\r\n            }\r\n            user.save();\r\n            events.emit(GameEvents.UPDATAUI);\r\n        }, 1);\r\n        FLog.normal('服务器金币数量:', data.num);\r\n    }\r\n\r\n    /**\r\n     * tipsAnim\r\n     */\r\n    public tipsAnim(num, updateNum) {\r\n        this.tipsLable[num].stopAllActions();\r\n        this.tipsLable[num].active = false;\r\n        this.tipsLable[num].position = cc.v2(62.5, -5);\r\n        this.tipsLable[num].opacity = 0;\r\n        if (num == 2) {\r\n            this.tipsLable[num].getComponent(cc.Label).string = `+${updateNum}`;\r\n        } else {\r\n            this.tipsLable[num].getComponent(cc.Label).string = `+${updateNum.toFixed(2)}`;\r\n        }\r\n        this.tipsLable[num].active = true;\r\n        let t = cc.tween;\r\n        t(this.tipsLable[num])\r\n            .parallel(\r\n                t().by(.2, { opacity: 255 }, { easing: 'backIn' }),\r\n                t().by(.2, { y: 5 }, { easing: 'backIn' })\r\n            )\r\n            .delay(1.5)\r\n            .call(() => {\r\n                this.tipsLable[num].active = false;\r\n                this.tipsLable[num].position = cc.v2(62.5, -5);\r\n                this.tipsLable[num].opacity = 0;\r\n            })\r\n            .start()\r\n    }\r\n\r\n    /**\r\n     * 打开红包弹窗\r\n     * @param videoName red或者hf\r\n     * @param isVideo 是否免费\r\n     */\r\n    openVidoe(videoName, getCardNum: number, isVideo = true) {\r\n        videoName.node.opacity = 255;\r\n        videoName.node.zIndex = 10;\r\n        user.setIsRedAndCost(false);\r\n        GameConstant.isAward = true;\r\n        user.save();\r\n        cc.tween(videoName.node)\r\n            .to(.3, { position: cc.v2(0, 0), scale: 2 })\r\n            .call(async () => {\r\n                // videoName.node.opacity = 0;\r\n                // videoName.node.zIndex = 1;\r\n\r\n                let awardNum: any = FSDK.getRandomReward()\r\n                let _data = [\"\", awardNum.num, \"Brick\", isVideo, videoName];\r\n\r\n                switch (awardNum.type) {\r\n                    case 1:\r\n                        _data[0] = \"gp\";\r\n                        break;\r\n                    case 2:\r\n                        _data[0] = \"pp\";\r\n                        break;\r\n                    case 3:\r\n                        _data[0] = \"credit\";\r\n                        _data[1] = user.getLumpData().bxCredit;\r\n                        break;\r\n                }\r\n\r\n                events.emit(GameEvents.SHOW_POPUP, PopUpName.SUPERPRIZE, null, _data);\r\n\r\n                if (user.IsShake) {\r\n                    FSDK.shake(50);\r\n                }\r\n            })\r\n            .start();\r\n    }\r\n}\r\n"]}