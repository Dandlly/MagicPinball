{"version":3,"sources":["assets\\script\\game\\Ball.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GameConstant, GameEvents } from \"../common/EventConstants\";\r\nimport { utils } from \"../common/Utils\";\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n/**\r\n * 作者:Dandlly\r\n */\r\n@ccclass\r\nexport default class Ball extends cc.Component {\r\n    @property()\r\n    isTouchedGround: boolean = false;\r\n\r\n    rigidBody: cc.RigidBody = null;\r\n    collider: cc.PhysicsBoxCollider = null;\r\n    private hurtNum: number = 1;\r\n    onLoad() {\r\n        this.rigidBody = this.getComponent(cc.RigidBody);\r\n        this.collider = this.getComponent(cc.PhysicsBoxCollider);\r\n        this.rigidBody.gravityScale = 0;\r\n    }\r\n\r\n    update(dt) {\r\n        if (this.isTouchedGround) {\r\n            this.isTouchedGround = false;\r\n\r\n            this.rigidBody.active = false\r\n            this.rigidBody.linearVelocity = cc.Vec2.ZERO;\r\n\r\n            this.node.color = cc.color().fromHEX(\"#02c9ff\");\r\n            //记录路径点\r\n            let pathPos = [];\r\n            pathPos.push(this.node.position);\r\n\r\n            if (this.node.position.x > 0) {\r\n                pathPos.push(cc.v2(345, -415))\r\n                pathPos.push(cc.v2(345, 397))\r\n                pathPos.push(cc.v2(0, 397))\r\n                pathPos.push(cc.v2(0, 390))\r\n            } else {\r\n                pathPos.push(cc.v2(-345, -415))\r\n                pathPos.push(cc.v2(-345, 397))\r\n                pathPos.push(cc.v2(0, 397))\r\n                pathPos.push(cc.v2(0, 390))\r\n            }\r\n\r\n            this.node.runAction(cc.sequence(\r\n                cc.cardinalSplineTo(1, pathPos, 0.9),\r\n                cc.callFunc(() => {\r\n                    this.rigidBody.gravityScale = 0;\r\n                    this.node.color = cc.color().fromHEX(\"#FFFFFF\");\r\n                    // if (this.hurtNum == 1) {\r\n                    // } else {\r\n                    //     this.node.color = cc.color().fromHEX(\"#FF0000\");\r\n                    // }\r\n                    this.rigidBody.active = true;\r\n                    GameConstant.game.recycleBall();\r\n                    this.rigidBody.type = cc.RigidBodyType.Static;\r\n                })\r\n            ))\r\n        }\r\n    }\r\n\r\n    onBeginContact(contact: cc.PhysicsContact, selfCollider, otherCollider) {\r\n        if (otherCollider.node.name == 'wall' || otherCollider.node.name.indexOf('polygon') != -1 || otherCollider.node.name == 'bx') {\r\n            if (this.rigidBody.gravityScale != 10) {\r\n                this.rigidBody.gravityScale = 10;\r\n            }\r\n            let plusOrMinus = Math.random() < 0.5 ? -1 : 1;\r\n            if (Math.abs(this.rigidBody.linearVelocity.y) < 200) {\r\n                this.rigidBody.applyForceToCenter(cc.v2(100 * plusOrMinus, 50000), true);\r\n            }\r\n        }\r\n\r\n        if (otherCollider.node.name == 'ground') {\r\n            this.isTouchedGround = true;\r\n        }\r\n    }\r\n\r\n    public getHurt() {\r\n        return this.hurtNum;\r\n    }\r\n\r\n    public setHurt(flag) {\r\n        this.hurtNum = flag;\r\n    }\r\n\r\n}\r\n"]}