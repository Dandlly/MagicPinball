{"version":3,"sources":["assets\\FSDK_ASS\\FSript\\FView\\FTransInfo.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { FPanelManager } from \"../FModel/FPanelManager\";\r\nimport { FGlobal } from \"../FModel/FGlobal\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class FTransInfo extends cc.Component {\r\n    @property(cc.Sprite)\r\n    mCardIcon: cc.Sprite = null;\r\n    @property(cc.Label)\r\n    mAmount: cc.Label = null;\r\n    @property(cc.Label)\r\n    mCoin: cc.Label = null;\r\n    @property(cc.ProgressBar)\r\n    mPro: cc.ProgressBar = null;\r\n    @property(cc.Label)\r\n    mProLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    mTaskLabel: cc.Label[] = [];\r\n    @property(cc.Button)\r\n    mRedeemBtn: cc.Button = null;\r\n    @property(cc.RichText)\r\n    mTip: cc.RichText = null;\r\n    @property(cc.AudioSource)\r\n    mErrSound: cc.AudioSource = null;\r\n    data = null;\r\n    confData = null;\r\n    taskPos = -1;\r\n    cb = null;\r\n    @property(cc.Sprite)\r\n    mIcon: cc.Sprite = null;\r\n    mIconSp = null;\r\n    onLoad() {\r\n        this.mRedeemBtn.node.on(cc.Node.EventType.TOUCH_END, this.getTrans, this);\r\n    }\r\n\r\n    setData(data) {\r\n        this.taskPos = -1;\r\n        this.data = data.data;\r\n        this.confData = data.confData;\r\n        this.mCardIcon.spriteFrame = this.data.icon;\r\n        this.mAmount.string = \"$\" + this.data.amount;\r\n        this.mCoin.string = this.confData.coin;\r\n        this.cb = data.cb;\r\n        let cnt = 0;\r\n        FSDK.getRegCnt(FNetWorkConfig.data.code, (data) => {\r\n            cnt = data[FNetWorkConfig.data.code];\r\n            this.mTip.string = FGlobal.exWenzi(FConfig.FSDK_CONF.word.tip12, this.getCnt(cnt));\r\n        })\r\n        this.mTip.string = FGlobal.exWenzi(FConfig.FSDK_CONF.word.tip12, this.getCnt(cnt));\r\n\r\n        this.isTaskSuc();\r\n    }\r\n\r\n    //显示任务并且返回是否可以领取\r\n    isTaskSuc() {\r\n        let target: number[] = [FGlobal.USER_INFO.credit, FGlobal.USER_INFO.task, FGlobal.USER_INFO.login_days];\r\n        for (let i = 0; i < 3; i++) {\r\n            this.mTaskLabel[i].node.active = false;\r\n        }\r\n        for (let i = 0; i < 3; i++) {\r\n            let pos = i + 1;\r\n            if (target[i] < this.confData['step' + pos]) {\r\n                this.mTaskLabel[i].node.active = true;\r\n                this.mTaskLabel[i].node.color = new cc.Color().fromHEX('#FFFFFF');\r\n                this.mRedeemBtn.interactable = false;\r\n                if (this.taskPos == -1) {\r\n                    this.taskPos = i;\r\n                }\r\n                this.mTaskLabel[i].string = \"Step\" + pos + \": \" + FGlobal.exWenzi(FConfig.FSDK_CONF.LIST_CONF.targetTitle[i], this.confData['step' + pos]);\r\n                break;\r\n\r\n            }\r\n            else {\r\n                this.mTaskLabel[i].string = \"Step\" + pos + \": \" + FGlobal.exWenzi(FConfig.FSDK_CONF.LIST_CONF.targetTitle[i], this.confData['step' + pos]);\r\n                this.mTaskLabel[i].node.active = true;\r\n                this.mTaskLabel[i].node.color = new cc.Color().fromHEX('#8CFF4B');\r\n                if (i == 2) {\r\n                    this.taskPos = i;\r\n                    this.mRedeemBtn.interactable = true;\r\n                }\r\n            }\r\n        }\r\n        if (this.taskPos == 0) {\r\n            this.mTaskLabel[0].string = FGlobal.exWenzi(FConfig.FSDK_CONF.LIST_CONF.targetTitle[0], this.confData['step' + 1]);\r\n        }\r\n        let pos = this.taskPos + 1;\r\n        this.mPro.progress = target[this.taskPos] / this.confData['step' + pos];\r\n        this.mProLabel.string = `${target[this.taskPos]}/${this.confData['step' + pos]}`;\r\n    }\r\n\r\n    closePage() {\r\n        FPanelManager.close_eff(this.node);\r\n    }\r\n\r\n    //计算出要显示的人数\r\n    getCnt(count) {\r\n        let cnt = count;\r\n        if (this.confData.type == 1 || this.confData.type == 2) {\r\n            switch (this.data.amount) {\r\n                case 10:\r\n                    cnt = Math.floor(count * 0.07 + 821);\r\n                    break;\r\n                case 25:\r\n                    cnt = Math.floor(count * 0.012 + 258);\r\n                    break;\r\n                case 50:\r\n                    cnt = Math.floor(count * 0.0017 + 70);\r\n                    break;\r\n            }\r\n        }\r\n        else if (this.confData.type == 3) {\r\n            switch (this.data.amount) {\r\n                case 10:\r\n                    cnt = Math.floor(count * 0.06 + 511);\r\n                    break;\r\n                case 25:\r\n                    cnt = Math.floor(count * 0.014 + 198);\r\n                    break;\r\n                case 50:\r\n                    cnt = Math.floor(count * 0.002 + 47);\r\n                    break;\r\n            }\r\n        }\r\n        else if (this.confData.type == 4) {\r\n            switch (this.data.amount) {\r\n                case 10:\r\n                    cnt = Math.floor(count * 0.02 + 144);\r\n                    break;\r\n                case 25:\r\n                    cnt = Math.floor(count * 0.007 + 85);\r\n                    break;\r\n                case 50:\r\n                    cnt = Math.floor(count * 0.0014 + 8);\r\n                    break;\r\n            }\r\n        }\r\n        return cnt;\r\n    }\r\n\r\n    getTrans() {\r\n        if (this.mRedeemBtn.interactable) {\r\n            if (this.confData.type != 3) {\r\n                FSDK.showToast(FConfig.FSDK_CONF.word.tip9)\r\n            }\r\n            else {\r\n                FSDK.showTransPage(this.node.parent, this.data, (status) => {\r\n                    if (this.cb) {\r\n                        this.cb();\r\n                        this.cb = null;\r\n                    }\r\n                }, 'list', true, this.mIconSp);\r\n                this.closePage();\r\n            }\r\n        }\r\n        else {\r\n            if (FGlobal.USER_INFO.setting.sound) {\r\n                this.mErrSound.play();\r\n            }\r\n            this.noSuc(this.mTaskLabel[this.taskPos].node)\r\n        }\r\n    }\r\n\r\n    //提示没完成\r\n    noSuc(node: cc.Node) {\r\n        node.stopAllActions();\r\n        node.scale = 1;\r\n        cc.tween(node)\r\n            .to(0.15, { scale: 1.1 })\r\n            .to(0.2, { scale: 1 })\r\n            .start();\r\n    }\r\n}\r\n"]}