{"version":3,"sources":["assets\\script\\game\\GameController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Ball from \"./Ball\";\r\nimport Barrier from \"./Barrier\";\r\nimport { GameEvents, GameConstant } from \"../common/EventConstants\";\r\nimport { events } from \"../common/Events\";\r\nimport { PopUpName } from \"../common/PopupConstants\";\r\nimport { user } from \"../common/User\";\r\nimport { utils } from \"../common/Utils\";\r\nimport { AudioName } from \"../common/AudioConstands\";\r\nimport { actions } from \"../common/Actions\";\r\nimport Cion from \"./Cion\";\r\n\r\ninterface Barriers {\r\n    name: string, // 名字\r\n    score: number,// 分数\r\n    pos: cc.Vec2, // 坐标\r\n    scale: number,// 大小\r\n    angle: number,// 角度\r\n    isRain: boolean,// 是否彩虹\r\n}\r\n\r\ninterface Balls {\r\n    hurt: number,\r\n    scale: number,\r\n}\r\nconst AddBarrierPosY: number = -300;\r\nconst { ccclass, property } = cc._decorator;\r\n/**\r\n * 作者:Dandlly\r\n */\r\n@ccclass\r\nexport default class GameController extends cc.Component {\r\n    @property(cc.Prefab)\r\n    prefabBarriers: cc.Prefab[] = [];\r\n    @property(cc.Prefab)\r\n    prefabFunBarriers: cc.Prefab[] = [];\r\n    // @property(cc.Prefab)\r\n    // prefabRedAndCost: cc.Prefab[] = [];\r\n    @property(cc.Prefab)\r\n    prefabBall: cc.Prefab = null;\r\n    @property(Ball)\r\n    balls: Ball[] = [];\r\n    @property(Barrier)\r\n    barriers: Barrier[] = [];\r\n    @property(cc.Label)\r\n    ballCount: cc.Label = null;\r\n    @property(cc.Node)\r\n    guide: cc.Node = null; //开局指引 节点\r\n    @property()\r\n    gameStatus: boolean = true;\r\n    @property(cc.Node)\r\n    takeAim: cc.Node = null //瞄准线 节点\r\n\r\n    @property(cc.Node)\r\n    ballParent: cc.Node = null;// 弹球父节点\r\n\r\n    @property(cc.Node)\r\n    barrierParent: cc.Node = null;// 障碍父节点\r\n\r\n    @property(cc.Node)\r\n    mPaomaNode: cc.Node = null;// 跑马灯节点\r\n\r\n    @property(cc.Node)\r\n    mAnimCions: cc.Node = null;// 金币节点\r\n\r\n    @property(cc.Node)\r\n    mCionsNode: cc.Node = null;// top货币节点\r\n\r\n    @property(cc.Node)\r\n    mStarUiNode: cc.Node = null;// Ui节点\r\n\r\n    @property(cc.Label)\r\n    levelLabel: cc.Label = null; // 当前等级\r\n\r\n    @property(cc.Label)\r\n    nextLevelLabel: cc.Label = null;// 下一等级\r\n\r\n    @property(cc.ProgressBar)\r\n    levelProgressBar: cc.ProgressBar = null;\r\n\r\n    private numTw: cc.Tween<any> = null;\r\n    private numTw1: cc.Tween<any> = null;\r\n    private _upgradeExp: number = 0;    // 所需经验\r\n\r\n    recordBall: Balls[] = [];\r\n    recordBarrier: Barriers[] = [];\r\n\r\n    recycleBallsCount: number = 1;\r\n    barrierScoreRate: number = 0;\r\n    score: number = 0;\r\n    isGameOver: boolean = false;\r\n\r\n    onLoad() {\r\n        //事件监听\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        events.on(this.name, this.uuid, GameEvents.UPDATALEVEL, this.updateLevel, this);\r\n        // events.on(this.name, this.uuid, GameEvents.UPDATASCORE, this.rollHandler, this);\r\n        this.openPm();\r\n    }\r\n\r\n    /**\r\n    * 打开跑马灯\r\n    */\r\n    public openPm(): void {\r\n        FSDK.showMarQuee(this.mPaomaNode);\r\n    }\r\n\r\n    //初始化\r\n    async init() {\r\n        if (user.passGuide) {\r\n            let num = user.getLumpData().reviveNum;\r\n            user.setCurrnetReviveNum(num);\r\n        }\r\n        for (let index = 0; index < user.getRecordBarrier().length; index++) {\r\n            if (user.getRecordBarrier()[index].pos.y > 300) {\r\n                this.restartInit();\r\n                return;\r\n            }\r\n        }\r\n        if (user.getRecordBarrier().length > 0 && user.getRecordBall().length > 0) {\r\n            this.guide.zIndex = 10;\r\n            this.guide.active = false;\r\n            this.initRecordBarrier();\r\n            this.initBalls();\r\n            this.gameStatus = true;\r\n            this.isGameOver = false;\r\n            this.setBallCount(user.getRecordBall().length);\r\n            this.recycleBallsCount = user.getRecordBall().length;\r\n        } else {\r\n            this.startBall();\r\n            this.gameStatus = true;\r\n            this.score = 0; //计分牌\r\n            this.recycleBallsCount = 10; //收回小球数\r\n            this.barrierScoreRate = 0; //设置障碍物基准率\r\n            this.guide.zIndex = 10;\r\n            this.guide.active = false;\r\n            this.isGameOver = false;\r\n            this.setBallCount(this.balls.length);\r\n            user.setIsRain(false);\r\n            user.setRainProbability(user.getLumpData().rainProbability);\r\n            for (let index = 0; index < 3; index++) {\r\n                await this.addBarriers(index);\r\n            }\r\n        }\r\n        this.updateLevel();\r\n        //显示游戏指引\r\n        this.guideShow();\r\n    }\r\n\r\n    //触摸开始时\r\n    onTouchStart() {\r\n        this.guideHide();\r\n    }\r\n\r\n    //触摸结束\r\n    onTouchEnd(touch) {\r\n        if (!this.isRecycleFinished()) {\r\n            return;\r\n        }\r\n        if (GameConstant.isAward) return;\r\n        let graphics = this.node.getChildByName(\"take-aim\").getComponent(cc.Graphics);\r\n        graphics.clear();\r\n        this.recycleBallsCount = 0;\r\n        let touchPos: cc.Vec2 = this.node.convertToNodeSpaceAR(touch.getLocation());\r\n\r\n        if (touchPos.y > 320) {\r\n            touchPos = new cc.Vec2(touchPos.x, 320);\r\n        }\r\n\r\n        this.shootBalls(touchPos.sub(cc.v2(0, 390)));\r\n    }\r\n\r\n    /**\r\n     * 初始化记录的障碍物\r\n     */\r\n    async initRecordBarrier() {\r\n        for (let i = 0; i < user.getRecordBarrier().length; i++) {\r\n            let barrier = await GPool.get(user.getRecordBarrier()[i].name);\r\n            barrier.parent = this.barrierParent;\r\n            barrier.position = user.getRecordBarrier()[i].pos;\r\n            barrier.angle = user.getRecordBarrier()[i].angle;\r\n            barrier.scale = user.getRecordBarrier()[i].scale;\r\n            if (user.getRecordBarrier()[i].name.indexOf(\"polygon\") != -1) {\r\n                barrier.getComponent(Barrier).init(user.getRecordBarrier()[i].score, user.getRecordBarrier()[i].isRain);\r\n            } else {\r\n                barrier.getComponent(Barrier).init(user.getRecordBarrier()[i].score)\r\n            }\r\n            this.barriers.push(barrier.getComponent(Barrier));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 初始化球体\r\n     */\r\n    async initBalls() {\r\n        for (let i = 0; i < user.getRecordBall().length; i++) {\r\n            let ball = await GPool.get('ball');\r\n            ball.parent = this.ballParent;\r\n            ball.position = cc.v2(0, 390);\r\n            ball.scale = user.getRecordBall()[i].scale;\r\n            ball.getComponent(cc.RigidBody).type = cc.RigidBodyType.Static;\r\n            ball.getComponent(Ball).setHurt(user.getRecordBall()[i].hurt);\r\n            this.balls.push(ball.getComponent(Ball));\r\n            // if (user.getRecordBall()[i].hurt == 1) {\r\n            //     this.node.color = cc.color().fromHEX(\"#FFFFFF\");\r\n            // } else {\r\n            //     this.node.color = cc.color().fromHEX(\"#FF0000\");\r\n            // }\r\n        }\r\n        this.setRecordBalls();\r\n    }\r\n\r\n    //开始初始化\r\n    startBall() {\r\n        for (let index = 0; index < 10; index++) {\r\n            GPool.get('ball').then((mNode: cc.Node) => {\r\n                mNode.parent = this.ballParent;\r\n                mNode.position = cc.v2(0, 390);\r\n                mNode.getComponent(cc.RigidBody).type = cc.RigidBodyType.Static;\r\n                this.balls.push(mNode.getComponent(Ball));\r\n                this.setBallCount(this.balls.length);\r\n            })\r\n        }\r\n        this.setRecordBalls();\r\n    }\r\n\r\n    // 新增小球\r\n    async addBall(pos: cc.Vec2) {\r\n        events.emit(GameEvents.PLAY_SOUND_EFFECT, AudioName.POP);// 添加道具音效\r\n        let ball = await GPool.get(this.prefabBall.name);\r\n        ball.parent = this.ballParent;\r\n        ball.position = pos;\r\n        ball.getComponent(Ball).rigidBody.linearVelocity = cc.v2(500 * Math.random() < 0.5 ? -1 : 1, -1000);\r\n        ball.getComponent(Ball).rigidBody.gravityScale = 10;\r\n        this.balls.push(ball.getComponent(Ball));\r\n        this.setBallCount(this.balls.length);\r\n        this.setRecordBalls();\r\n    }\r\n\r\n    // 新增障碍物\r\n    async addBarriers(index?: number) {\r\n        // let startPosX = -250;\r\n        let startPosY = AddBarrierPosY;\r\n        // let endPosX = 250;\r\n        // let currentPosX = startPosX + this.getRandomSpace();\r\n        user.setCurrentLine();\r\n        user.setCurrentRenLine();\r\n\r\n        let barrierNum = this.getInitBarrierRandom();// 实例化个数\r\n        let posX = this.backBarrierPosX(barrierNum);\r\n        let initNum = 0;\r\n        // FLog.normal(\"数组\", barrierNum, posX);\r\n        if (index) {\r\n            startPosY = AddBarrierPosY + 100 * index;\r\n        }\r\n        // 红包\r\n        let getNum: number;\r\n        user.getAwardNumber() <= user.getLumpData().outOfRedAndCost[0] ? getNum = user.getLumpData().outOfRedAndCost[0] : getNum = user.getLumpData().outOfRedAndCost[1];\r\n\r\n\r\n        let initRedWeight = utils.randomInt([1, 10]);// 实例化红包的几率\r\n        let _mpoint = user.getLumpData().videoAddPoint;// 宝箱后台个数概率\r\n        let _mbxWeigt = user.getLumpData().videoBaoXiang;// 宝箱后台概率\r\n        let isIntsRed: boolean = false;\r\n\r\n\r\n\r\n        // 大于每日产出数 不在产出宝箱\r\n        if (user.getAwardNumber() >= _mpoint[_mpoint.length - 1]) {\r\n            isIntsRed = false;\r\n        }\r\n\r\n        //道具权重\r\n        let isInitProp = false; // 是否已经改行实例化道具了\r\n\r\n        // 每5行必定随机一个道具出来\r\n        let fiveIsProp: any = user.getCurrentLine() % user.getLumpData().addProp === 0;\r\n\r\n        while (initNum < barrierNum) {\r\n            let barrier;\r\n            let awardNum: any = FSDK.getCard(0);\r\n\r\n            for (let i = 0; i < _mpoint.length; i++) {\r\n                // 判断个数\r\n                if (user.getAwardNumber() <= _mpoint[i]) {\r\n                    // 判断概率\r\n                    if (initRedWeight <= _mbxWeigt[i]) {\r\n                        isIntsRed = true;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (user.serverData.isFlag && !user.serverData.isBlack\r\n                && !user.getIsRedAndCost()\r\n                && isIntsRed\r\n                && (awardNum.num > 0 || (user.getCurrentRedLine() != 0 && user.getCurrentRedLine() % getNum == 0))) {\r\n                user.setIsRedAndCost(true);\r\n                user.save();\r\n                // 实例化红包\r\n                barrier = await GPool.get('bx');\r\n                // 播放音效\r\n                events.emit(GameEvents.PLAY_SOUND_EFFECT, AudioName.DINGDONG);\r\n                user.setCurrentRenLine(0);\r\n                isIntsRed = false;\r\n            } else if (fiveIsProp && !isInitProp\r\n                && (this.isAllBallBig() || this.balls.length < user.getLumpData().MaxBallCount)\r\n                && user.getCurrentProp() < 2) {\r\n\r\n                let _oldProp = user.getCurrentProp();\r\n                _oldProp += 1;\r\n                user.setCurrentProp(_oldProp);\r\n                isInitProp = true;\r\n                if (this.balls.length >= user.getLumpData().MaxBallCount) {\r\n                    barrier = await GPool.get(\"buffBigBall\");\r\n                } else if (!this.isAllBallBig()) {\r\n                    barrier = await GPool.get(\"buffAddBall\");\r\n                } else {\r\n                    let weightPorp = utils.randomInt([0, 1]);\r\n                    barrier = await GPool.get(this.prefabFunBarriers[weightPorp].name);\r\n                }\r\n            } else {\r\n                barrier = await GPool.get(this.prefabBarriers[Math.floor(Math.random() *\r\n                    this.prefabBarriers.length)].name);\r\n            }\r\n            this.barrierParent.addChild(barrier)\r\n            barrier.position = cc.v2(posX[initNum], startPosY);\r\n            barrier.getComponent(Barrier).init();\r\n            this.barriers.push(barrier.getComponent(Barrier));\r\n            initNum++;\r\n        }\r\n\r\n        // 检测彩虹\r\n        this.isAddRaindow(startPosY);\r\n\r\n        this.isBarrierPos();\r\n        this.setRecordBarriers();\r\n    }\r\n\r\n    // 小球变大\r\n    bigBall(node: cc.Node) {\r\n        events.emit(GameEvents.PLAY_SOUND_EFFECT, AudioName.POP);// 添加道具音效\r\n        node.scale = user.getLumpData().MaxBigBall;\r\n        // node.color = cc.color().fromHEX(\"#FF0000\");\r\n        node.getComponent(Ball).setHurt(2);\r\n    }\r\n\r\n    //显示小球总数\r\n    setBallCount(num: number) {\r\n        this.ballCount.string = num.toString();\r\n    }\r\n\r\n    //连续发射小球\r\n    shootBalls(dir) {\r\n        if (!this.gameStatus) {\r\n            return;\r\n        }\r\n        GameConstant.isShoot = true;\r\n        for (let i = 0; i < this.balls.length; i++) {\r\n            let ball = this.balls[i];\r\n\r\n            this.scheduleOnce(() => {\r\n                this.shootBall(ball, dir);\r\n            }, i * 0.1)\r\n        }\r\n    }\r\n\r\n    //发射单个小球\r\n    shootBall(ball: Ball, dir) {\r\n        ball.node.getComponent(cc.RigidBody).type = cc.RigidBodyType.Dynamic;\r\n        ball.rigidBody.active = false;\r\n        events.emit(GameEvents.PLAY_SOUND_EFFECT, AudioName.CRASH);// 添加射击音效\r\n        ball.rigidBody.active = true;\r\n        var angle = Math.atan2(dir.y, dir.x) / Math.PI * 180;\r\n        var toX = Math.cos(angle * 0.017453293) * 100;\r\n        var toY = Math.sin(angle * 0.017453293) * 100;\r\n        ball.rigidBody.linearVelocity = cc.v2(toX * 20, toY * 20);\r\n    }\r\n\r\n    //收回小球，上移一排障碍物\r\n    recycleBall() {\r\n        this.recycleBallsCount++;\r\n        this.barrierScoreRate += 0.1;\r\n\r\n        if (this.isRecycleFinished()) {\r\n            for (let i = 0; i < this.barriers.length; i++) {\r\n                let barrier = this.barriers[i];\r\n                if (this.barriers[i].getScore() == 0 && barrier.node.name === 'bx') {\r\n                    events.emit(GameEvents.OPENVDIEO, this.barriers[i], 0);\r\n                    return;\r\n                }\r\n            }\r\n            this.moveBarriesr();\r\n        }\r\n    }\r\n\r\n    moveBarriesr() {\r\n        for (let i = 0; i < this.barriers.length; i++) {\r\n            let barrier = this.barriers[i];\r\n            cc.tween(barrier.node)\r\n                .by(0.1, { position: cc.v2(0, 100) })\r\n                .call(() => {\r\n                    this.setRecordBarriers();\r\n                    if (barrier.node.position.y > 200) {\r\n                        if (user.IsShake) {\r\n                            FSDK.shake(50);\r\n                        }\r\n                        // 抖动\r\n                        barrier.node.runAction(cc.shake(1.5, 5, 5));\r\n                    }\r\n                    if (barrier.node.position.y >= 390) {\r\n                        if (barrier.node.name == \"buffAddBall\" || barrier.node.name == \"buffBigBall\") {\r\n                            this.removeBarrier(barrier);\r\n                            let _oldProp = user.getCurrentProp();\r\n                            _oldProp -= 1;\r\n                            user.setCurrentProp(_oldProp);\r\n                        } else {\r\n                            this.gameOver();\r\n                        }\r\n                    }\r\n                })\r\n                .start()\r\n        }\r\n        this.isBarrierPos();\r\n        this.setRecordBalls();\r\n        this.scheduleOnce(() => {\r\n            this.addBarriers();\r\n        }, .2)\r\n        GameConstant.isShoot = false;\r\n    }\r\n\r\n    isVideoAddBarriers() {\r\n        for (let i = 0; i < this.barriers.length; i++) {\r\n            let barrier = this.barriers[i];\r\n            cc.tween(barrier.node)\r\n                .by(0.1, { position: cc.v2(0, 100) })\r\n                .call(() => {\r\n                    if (barrier.node.position.y > 200) {\r\n                        if (user.IsShake) {\r\n                            FSDK.shake(50);\r\n                        }\r\n                        // 抖动\r\n                        barrier.node.runAction(cc.shake(1.5, 5, 5));\r\n                    }\r\n                    if (barrier.node.position.y >= 390) {\r\n                        if (barrier.node.name == \"buffAddBall\" || barrier.node.name == \"buffBigBall\") {\r\n                            this.removeBarrier(barrier);\r\n                            let _oldProp = user.getCurrentProp();\r\n                            _oldProp -= 1;\r\n                            user.setCurrentProp(_oldProp);\r\n                        } else {\r\n                            this.gameOver();\r\n                        }\r\n                    }\r\n                })\r\n                .start()\r\n        }\r\n        this.isBarrierPos();\r\n        this.setRecordBalls();\r\n        this.scheduleOnce(() => {\r\n            this.addBarriers();\r\n        }, .2)\r\n        GameConstant.isShoot = false;\r\n    }\r\n\r\n    /**\r\n     * 判断所在有在场的节点\r\n     */\r\n    public isBarrierPos() {\r\n        for (let index = 0; index < this.barriers.length; index++) {\r\n            if (this.barriers[index].node.position.x < -260 && this.barriers[index].node.position.x > 260 || this.barriers[index].node.position.y < AddBarrierPosY) {\r\n                if (this.barriers[index].node.name == \"bx\") {\r\n                    user.setIsRedAndCost(false);\r\n                }\r\n                // 不知道啥原因出界了\r\n                this.removeBarrier(this.barriers[index]);\r\n            }\r\n        }\r\n    }\r\n\r\n    //游戏结束\r\n    gameOver() {\r\n        if (this.isGameOver) return;\r\n        this.isGameOver = true;\r\n        events.emit(GameEvents.PLAY_SOUND_EFFECT, AudioName.SETTLEMENT);// 添加结算音效\r\n        this.gameStatus = false;\r\n        let data = this.score.toString();\r\n        FLog.normal(\"游戏结算\");\r\n        events.emit(GameEvents.SHOW_POPUP, PopUpName.GAMEOVER, null, data);\r\n\r\n    }\r\n\r\n    //小球是否收回完毕\r\n    isRecycleFinished() {\r\n        return this.recycleBallsCount == this.balls.length;\r\n    }\r\n\r\n    //抖动障碍物\r\n    shake(barrier: cc.Node) {\r\n        if (barrier.getNumberOfRunningActions() > 0) return;\r\n        if (user.IsShake) {\r\n            FSDK.shake(30);\r\n        }\r\n        let shake = cc.shake(0.1, 5, 5);\r\n        barrier.runAction(shake);\r\n    }\r\n\r\n    //计分牌显示\r\n    addScore(score: number) {\r\n        score *= user.getLumpData().expSate;\r\n\r\n        let exp = user.getExp();\r\n        exp += score;\r\n        user.setExp(exp);\r\n\r\n        let expDay = user.getExpDay();\r\n        expDay += score;\r\n        user.setExpDay(expDay)\r\n\r\n        this.updateLevel();\r\n    }\r\n\r\n    //设置障碍物自身分数值(海外现在改为按照等级)\r\n    setBarrierScore() {\r\n        let min = Math.floor((user.getCurrentLine() ** user.getLumpData().levelFormula[0][0]) * user.getLumpData().levelFormula[0][1] + user.getLumpData().levelFormula[0][2]);\r\n        let max = Math.floor((user.getCurrentLine() ** user.getLumpData().levelFormula[1][0]) * user.getLumpData().levelFormula[1][1] + user.getLumpData().levelFormula[1][2]);\r\n\r\n        let _score: number = utils.randomInt(min, max);\r\n        return _score;\r\n    }\r\n\r\n    //消除障碍物\r\n    removeBarrier(barrier, isResurgence: boolean = false) {\r\n        events.emit(GameEvents.PLAY_SOUND_EFFECT, AudioName.ELIMINATE);// 添加消除音效\r\n        let idx = this.barriers.indexOf(barrier);\r\n        if (barrier.node.name != \"buffAddBall\" && barrier.node.name != \"buffBigBall\" && barrier.node.name != \"bx\") {\r\n            if (barrier.node.getChildByName('IrisAnim').active) {\r\n                barrier.node.getChildByName('IrisAnim').active = false;\r\n                if (!isResurgence) {\r\n                    console.log(\"222222222222222\");\r\n                    //  金币特效\r\n                    this.piaoBigCoin()\r\n                    FSDK.setCredit('credit', 50, \"Brick\");\r\n                    FSDK.showToast(`Congratulations on receiving ${50} gold coins`);\r\n                }\r\n                user.setIsRain(false);\r\n                user.setRainProbability(user.getLumpData().rainProbability);\r\n            } else if (!isResurgence) {\r\n                this.getCoin(barrier.node.position);\r\n            }\r\n        }\r\n\r\n        if (idx != -1) {\r\n            GPool.put(barrier.node);\r\n            this.barriers.splice(idx, 1);\r\n            user.setDeleteBarriersNum();// 计算销毁个数\r\n            this.setRecordBarriers();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取金币\r\n     */\r\n    public getCoin(pos) {\r\n        // 金币产出\r\n        // 本地金币少于10000 \r\n        let level = -1;\r\n        level = FSDK.getCreditDif();\r\n        let awardNum = utils.randomInt(user.getLumpData().LevelCions[level]);\r\n\r\n        if (awardNum === 0) return;\r\n        if (user.getCollectCoins() < user.getLumpData().CollectCoins[0]) {\r\n            // 小于10000金币\r\n            this.animCion(awardNum, 2, true, pos);\r\n            FSDK.setCredit('credit', awardNum, \"Brick\");\r\n\r\n            let old = user.getCollectCoins();\r\n            old += awardNum;\r\n            user.setCollectCoins(old);\r\n        } else if (user.getCollectCoins2() < user.getLumpData().CollectCoins[1]) {\r\n            // 每日产出2000\r\n            this.animCion(awardNum, 2, true, pos);\r\n            FSDK.setCredit('credit', awardNum, \"Brick\");\r\n\r\n            let old = user.getCollectCoins2();\r\n            old += awardNum;\r\n            user.setCollectCoins2(old);\r\n        }\r\n    }\r\n\r\n\r\n    //获取随机距离，用于生成障碍物的间距\r\n    getRandomSpace() {\r\n        return 100 + Math.random() * 150;\r\n    }\r\n\r\n    //获取区间随机值\r\n    randomNum(Min, Max) {\r\n        var Range = Max - Min;\r\n        var Rand = Math.random();\r\n        var num = Min + Math.floor(Rand * Range);\r\n        return num;\r\n    }\r\n\r\n    //显示引导动画\r\n    guideShow() {\r\n        this.guide.active = true;\r\n        let handMove = this.guide.getChildByName('handMove');\r\n        let animCtrl = handMove.getComponent(cc.Animation);\r\n        animCtrl.play('handMove');\r\n    }\r\n\r\n    /**\r\n     * 关闭引导动画\r\n     */\r\n    guideHide() {\r\n        this.guide.active = false;\r\n        let handMove = this.guide.getChildByName('handMove');\r\n        let animCtrl = handMove.getComponent(cc.Animation);\r\n        animCtrl.stop('handMove');\r\n    }\r\n\r\n    // 重新开始\r\n    restartInit() {\r\n        this.score = 0; //计分牌\r\n        this.recycleBallsCount = 10; //收回小球数\r\n        this.barrierScoreRate = 0; //设置障碍物基准率\r\n        this.guide.zIndex = 10;\r\n        this.guide.active = false;\r\n\r\n        user.setCurrentProp(0);\r\n        user.setIsRedAndCost(false);\r\n        user.setCurrentLine(0);\r\n\r\n        user.setIsRain(false);\r\n        user.setRainProbability(user.getLumpData().rainProbability);\r\n        user.save();\r\n        this.balls = [];\r\n        this.ballParent.removeAllChildren();\r\n\r\n        this.barriers = [];\r\n        this.barrierParent.removeAllChildren();\r\n        this.setBallCount(this.balls.length);\r\n        this.startBall();\r\n        for (let index = 0; index < 3; index++) {\r\n            this.addBarriers(index);\r\n        }\r\n        //显示游戏指引\r\n        this.guideShow();\r\n        this.gameStatus = true;\r\n        this.isGameOver = false;\r\n    }\r\n\r\n    /**\r\n     * 复活（减去上面3行）\r\n     */\r\n    resurgence() {\r\n        for (let index = 0; index < this.barriers.length; index++) {\r\n            let barrier = this.barriers[0];\r\n            if (barrier.node.position.y >= 0) {\r\n                if (barrier.node.name == \"buffAddBall\" || barrier.node.name == \"buffBigBall\") {\r\n                    let propNum = user.getCurrentProp();\r\n                    propNum -= 1;\r\n                    user.setCurrentProp(propNum);\r\n                } else if (barrier.node.name == \"bx\") {\r\n                    user.setIsRedAndCost(false);\r\n                } else if (barrier.node.getChildByName('IrisAnim').active) {\r\n                    user.setIsRain(false);\r\n                    user.setRainProbability(user.getLumpData().rainProbability);\r\n                }\r\n                this.removeBarrier(barrier, true);\r\n            }\r\n        }\r\n        user.save();\r\n        this.guide.zIndex = 10;\r\n        this.guide.active = false;\r\n        //显示游戏指引\r\n        this.guideShow();\r\n        this.gameStatus = true;\r\n        this.isGameOver = false;\r\n    }\r\n\r\n    /**\r\n     * 判断是否全部为大球\r\n     */\r\n    isAllBallBig() {\r\n        let num = 0;\r\n        let isOne = true;\r\n        for (let index = 0; index < this.balls.length; index++) {\r\n            let ball = this.balls[index];\r\n            if (ball.getHurt() == 2) {\r\n                num++;\r\n                this.setRecordBalls();\r\n            }\r\n        }\r\n        for (let i = 0; i < this.barriers.length; i++) {\r\n            if (this.barriers[i].node.name == \"buffBigBall\") {\r\n                isOne = false;\r\n            }\r\n        }\r\n        if ((!isOne && num == this.balls.length - 1) || num === this.balls.length) {\r\n            return false;\r\n        }\r\n        return true\r\n    }\r\n\r\n    /**\r\n     * 记录障碍物到数据\r\n     */\r\n    public setRecordBarriers() {\r\n        let barrierData: Barriers[] = [];\r\n        for (let index = 0; index < this.barriers.length; index++) {\r\n            let barrier = this.barriers[index];\r\n            let _data: Barriers = {\r\n                name: barrier.node.name,\r\n                pos: barrier.node.position,\r\n                scale: barrier.node.scale,\r\n                angle: barrier.node.angle,\r\n                score: barrier.getScore(),\r\n                isRain: false\r\n            };\r\n            if (barrier.node.name.indexOf(\"polygon\") != -1) {\r\n                _data.isRain = barrier.node.getChildByName('IrisAnim').active;\r\n            }\r\n            barrierData.push(_data);\r\n        }\r\n        user.setRecordBarrier(barrierData);\r\n        user.save();\r\n    }\r\n\r\n    /**\r\n     * 记录球到数据\r\n     */\r\n    public setRecordBalls() {\r\n        let ballData: Balls[] = [];\r\n        for (let index = 0; index < this.balls.length; index++) {\r\n            let ball = this.balls[index];\r\n            let _data: Balls = {\r\n                hurt: ball.getHurt(),\r\n                scale: ball.node.scale\r\n            };\r\n            ballData.push(_data);\r\n        }\r\n        user.setRecordBall(ballData);\r\n        user.save();\r\n    }\r\n\r\n    /**\r\n     * 障碍物实例化数量\r\n     */\r\n    public getInitBarrierRandom(): number {\r\n        return utils.randomInt(user.getLumpData().initBarrierlArr);\r\n    }\r\n\r\n    /**\r\n     * 随机返回一个坐标\r\n     */\r\n    public backBarrierPosX(num) {\r\n        let posX_Arr: number[] = user.getLumpData().barrierlArrPosX.concat();\r\n        let _pox = posX_Arr;\r\n        let rePox = [];\r\n        for (let i = 0; i < num; i++) {\r\n            let _posX = utils.randomInt(0, _pox.length - 1);\r\n            rePox.push(_pox[_posX]);\r\n            _pox.splice(_posX, 1);\r\n        }\r\n        return rePox;\r\n    }\r\n\r\n    /**\r\n     * 货币动画\r\n     * @param num 数量 \r\n     * @param type 0=gp 1=pp 2=金币\r\n     */\r\n    public async animCion(num: number, type: number, isOne: boolean = true, statrPos: cc.Vec2 = cc.v2()) {\r\n        let coin = this.mCionsNode.children[type];\r\n        let name;\r\n        if (type == 0) name = \"gp\";\r\n        if (type == 1) name = \"pp\";\r\n        if (type == 2) name = \"credit\";\r\n        if (!name) return;\r\n\r\n        let cb = () => {\r\n            events.emit(GameEvents.PLAY_SOUND_EFFECT, AudioName.CION);\r\n        }\r\n\r\n        if (type == 2 && isOne) {\r\n            for (let index = 0; index < num; index++) {\r\n                actions.addCionMove(this.mAnimCions, name, cc.v2(), coin.position.add(coin.getChildByName(name).position), cb, num - index == 1);\r\n            }\r\n        } else {\r\n            for (let index = 0; index < 10; index++) {\r\n                actions.addCionMove(this.mAnimCions, name, statrPos, coin.position.add(coin.getChildByName(name).position), cb, 10 - index == 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 球的伤害计算\r\n     */\r\n    public hurtState(): number {\r\n        let hurt = 1;\r\n        if (hurt != user.getLumpData().expDayCount) {\r\n            hurt = user.getLumpData().hurt;\r\n        }\r\n        return hurt;\r\n    }\r\n\r\n    /**\r\n     * 更新游戏里面的等级\r\n     */\r\n    public updateLevel() {\r\n        let level = user.getLevel();\r\n\r\n        let expData: any = user.getLumpData().exp[level - 1];\r\n        this._upgradeExp = expData.exp;\r\n\r\n        let exp = user.getExp();\r\n\r\n        if (exp >= this._upgradeExp) {\r\n            level++;\r\n            user.setLevel(level);\r\n\r\n            // 埋点\r\n            let _data = FSDK.getUserType();// 返回新老用户\r\n            if (_data == 'new') {\r\n                // 返回当前等级\r\n                FSDK.umengEvent('GAME_LV_NEW', `${level}`);\r\n            }\r\n            // 无论新老用户都返回\r\n            FSDK.umengEvent('GAME_LV_ALL', `${level}`);\r\n\r\n            exp = exp - this._upgradeExp;\r\n            user.setExp(exp);\r\n            user.save();\r\n        }\r\n\r\n        this.levelBar();\r\n\r\n        this.levelLabel.string = `${user.getLevel()}`;\r\n        this.nextLevelLabel.string = `${user.getLevel() + 1}`;\r\n    }\r\n\r\n    /**等级滚动 */\r\n    levelBar() {\r\n        if (this.numTw) {\r\n            this.numTw.stop();\r\n        }\r\n        this.numTw = cc.tween(this)\r\n            .to(.2, { levellab: Number(user.getExp() / this._upgradeExp) })\r\n            .start();\r\n    }\r\n    get levellab(): number {\r\n        return Number(this.levelProgressBar.progress);\r\n    }\r\n    set levellab(text: number) {\r\n        this.levelProgressBar.progress = text;\r\n        if (this.levelProgressBar.progress >= 1) {\r\n            this.levelProgressBar.progress = 0;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 彩虹动画\r\n     */\r\n    public async rainAnim(barrier: cc.Node) {\r\n        // 播放音效\r\n        events.emit(GameEvents.PLAY_SOUND_EFFECT, AudioName.DINGDONG);\r\n\r\n\r\n        let anim = await GPool.get('synthetic');\r\n        anim.parent = this.mAnimCions;\r\n        anim.position = barrier.position;\r\n        anim.scale = barrier.scale;\r\n        anim.getComponent(cc.Animation).play();\r\n\r\n        barrier.getChildByName(\"rainbow\").active = true;\r\n        barrier.getChildByName('IrisAnim').active = true; // 光圈\r\n        this.setRecordBarriers();\r\n        this.scheduleOnce(() => {\r\n            GPool.put(anim);\r\n        }, 0.75);\r\n    }\r\n\r\n    async piaoBigCoin(coinnum?, pos?) {\r\n        let allnum = 100;\r\n\r\n        events.emit(GameEvents.PLAY_SOUND_EFFECT, AudioName.BIGWINGOLD);\r\n\r\n        if (coinnum) {\r\n            allnum = coinnum;\r\n        }\r\n\r\n        // actions.rockAction(this.node);\r\n\r\n\r\n\r\n        if (user.IsShake) {\r\n            FSDK.shake(100);\r\n        }\r\n\r\n        for (let i = 0; i < allnum; i++) {\r\n            let coins = await GPool.get('raindowCion');\r\n            coins.parent = this.mAnimCions;\r\n            coins.scale = 0.5;\r\n            if (pos) {\r\n                coins.position = pos;\r\n            } else {\r\n                coins.setPosition(0, 0)\r\n            }\r\n\r\n            coins.rotation = Math.random() * 360;\r\n            coins.getComponent(Cion).coinBigJump();\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 是否生成彩虹\r\n     * @param startPosY \r\n     */\r\n    public isAddRaindow(startPosY) {\r\n        // 判断是否生成彩虹方块\r\n        if (user.getRainAwardNum() <= user.getLumpData().rainAwardMax && !user.getIsRain()) {\r\n            let line = user.getCurrentLine();\r\n            let initRaindow = false;\r\n\r\n            let barrierArr = [];\r\n            if (line == 3) {\r\n                for (let i = 0; i < this.barriers.length; i++) {\r\n                    if (this.barriers[i].node.name.indexOf(\"polygon\") != -1 && this.barriers[i].node.position.y == startPosY) {\r\n                        barrierArr.push(this.barriers[i].score);\r\n                    }\r\n                }\r\n                let bigNum = Math.max.apply(this, barrierArr);\r\n                for (let k = 0; k < this.barriers.length; k++) {\r\n                    if (this.barriers[k].node.name.indexOf(\"polygon\") != -1 && this.barriers[k].node.position.y == startPosY) {\r\n                        if (this.barriers[k].score == bigNum) {\r\n                            this.rainAnim(this.barriers[k].node);\r\n                            user.setIsRain(true);\r\n                            user.setRainProbability(user.getLumpData().rainProbability);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            } else if (line > 2) {\r\n                // 计算概率\r\n                let probability = user.getRainProbability();\r\n                if (Math.random() <= probability) {\r\n                    initRaindow = true;\r\n                } else {\r\n                    probability += 0.1;\r\n                    user.setRainProbability(probability);\r\n                }\r\n\r\n                if (initRaindow) {\r\n                    for (let i = 0; i < this.barriers.length; i++) {\r\n                        if (this.barriers[i].node.name.indexOf(\"polygon\") != -1) {\r\n                            barrierArr.push(this.barriers[i].score);\r\n                        }\r\n                    }\r\n\r\n                    let bigNum = Math.max.apply(this, barrierArr);\r\n\r\n                    for (let k = 0; k < this.barriers.length; k++) {\r\n                        if (this.barriers[k].node.name.indexOf(\"polygon\") != -1) {\r\n                            if (this.barriers[k].score == bigNum) {\r\n                                this.rainAnim(this.barriers[k].node);\r\n                                user.setIsRain(true);\r\n                                user.setRainProbability(user.getLumpData().rainProbability);\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            // user.save();\r\n\r\n        }\r\n    }\r\n\r\n}\r\n\r\n"]}